# US GPO Medicare & You 2017
# Assignment optimziation model written by Bill Seliger
# Linear Decision model assuming Handbooks can't be split across plants

# Received new cost data from RRDL 7/19 - comprisig TL and IM rates for each population center

setwd("C:/Users/rr046302/Documents/Customers/GPO/Medicare & You 2017/Mapping Data")

library("gurobi")

model <- list()
# matrix representing quantity by Handbook for each plant
# columns = plants * Versions (Handbooks)
# rows = handbooks + plants
model$A          <- matrix(c(
  c(rep(1818367,11)),c(rep(0,35*11)),
  c(rep(0,1*11)),c(rep(2496868,11)),c(rep(0,34*11)),
  c(rep(0,2*11)),c(rep(257789,11)),c(rep(0,33*11)),
  c(rep(0,3*11)),c(rep(848793,11)),c(rep(0,32*11)),
  c(rep(0,4*11)),c(rep(358645,11)),c(rep(0,31*11)),
  c(rep(0,5*11)),c(rep(285399,11)),c(rep(0,30*11)),
  c(rep(0,6*11)),c(rep(619993,11)),c(rep(0,29*11)),
  c(rep(0,7*11)),c(rep(514479,11)),c(rep(0,28*11)),
  c(rep(0,8*11)),c(rep(376205,11)),c(rep(0,27*11)),
  c(rep(0,9*11)),c(rep(857871,11)),c(rep(0,26*11)),
  c(rep(0,10*11)),c(rep(428549,11)),c(rep(0,25*11)),
  c(rep(0,11*11)),c(rep(619254,11)),c(rep(0,24*11)),
  c(rep(0,12*11)),c(rep(1452384,11)),c(rep(0,23*11)),
  c(rep(0,13*11)),c(rep(1651169,11)),c(rep(0,22*11)),
  c(rep(0,14*11)),c(rep(1582272,11)),c(rep(0,21*11)),
  c(rep(0,15*11)),c(rep(802776,11)),c(rep(0,20*11)),
  c(rep(0,16*11)),c(rep(718616,11)),c(rep(0,19*11)),
  c(rep(0,17*11)),c(rep(1186635,11)),c(rep(0,18*11)),
  c(rep(0,18*11)),c(rep(1731557,11)),c(rep(0,17*11)),
  c(rep(0,19*11)),c(rep(1237234,11)),c(rep(0,16*11)),
  c(rep(0,20*11)),c(rep(306852,11)),c(rep(0,15*11)),
  c(rep(0,21*11)),c(rep(1038711,11)),c(rep(0,14*11)),
  c(rep(0,22*11)),c(rep(1353168,11)),c(rep(0,13*11)),
  c(rep(0,23*11)),c(rep(691245,11)),c(rep(0,12*11)),
  c(rep(0,24*11)),c(rep(236866,11)),c(rep(0,11*11)),
  c(rep(0,25*11)),c(rep(201868,11)),c(rep(0,10*11)),
  c(rep(0,26*11)),c(rep(926092,11)),c(rep(0,9*11)),
  c(rep(0,27*11)),c(rep(258658,11)),c(rep(0,8*11)),
  c(rep(0,28*11)),c(rep(138186,11)),c(rep(0,7*11)),
  c(rep(0,29*11)),c(rep(657088,11)),c(rep(0,6*11)),
  c(rep(0,30*11)),c(rep(218927,11)),c(rep(0,5*11)),
  c(rep(0,31*11)),c(rep(876851,11)),c(rep(0,4*11)),
  c(rep(0,32*11)),c(rep(430796,11)),c(rep(0,3*11)),
  c(rep(0,33*11)),c(rep(733698,11)),c(rep(0,2*11)),
  c(rep(0,34*11)),c(rep(581636,11)),c(rep(0,1*11)),
  c(rep(0,35*11)),c(rep(232633,11)), 
  
  1818367,c(rep(0,10)),2496868,c(rep(0,10)),257789,c(rep(0,10)),848793,c(rep(0,10)),358645,c(rep(0,10)),285399,c(rep(0,10)),619993,c(rep(0,10)),
  514479,c(rep(0,10)),376205,c(rep(0,10)),857871,c(rep(0,10)),428549,c(rep(0,10)),619254,c(rep(0,10)),1452384,c(rep(0,10)),1651169,c(rep(0,10)),
  1582272,c(rep(0,10)),802776,c(rep(0,10)),718616,c(rep(0,10)),1186635,c(rep(0,10)),1731557,c(rep(0,10)),1237234,c(rep(0,10)),306852,c(rep(0,10)),
  1038711,c(rep(0,10)),1353168,c(rep(0,10)),691245,c(rep(0,10)),236866,c(rep(0,10)),201868,c(rep(0,10)),926092,c(rep(0,10)),258658,c(rep(0,10)),138186,c(rep(0,10)),
  657088,c(rep(0,10)),218927,c(rep(0,10)),876851,c(rep(0,10)),430796,c(rep(0,10)),733698,c(rep(0,10)),581636,c(rep(0,10)),232633,c(rep(0,10)),
  
  0,1818367,c(rep(0,10)),2496868,c(rep(0,10)),257789,c(rep(0,10)),848793,c(rep(0,10)),358645,c(rep(0,10)),285399,c(rep(0,10)),619993,c(rep(0,10)),
  514479,c(rep(0,10)),376205,c(rep(0,10)),857871,c(rep(0,10)),428549,c(rep(0,10)),619254,c(rep(0,10)),1452384,c(rep(0,10)),1651169,c(rep(0,10)),
  1582272,c(rep(0,10)),802776,c(rep(0,10)),718616,c(rep(0,10)),1186635,c(rep(0,10)),1731557,c(rep(0,10)),1237234,c(rep(0,10)),306852,c(rep(0,10)),
  1038711,c(rep(0,10)),1353168,c(rep(0,10)),691245,c(rep(0,10)),236866,c(rep(0,10)),201868,c(rep(0,10)),926092,c(rep(0,10)),258658,c(rep(0,10)),138186,c(rep(0,10)),
  657088,c(rep(0,10)),218927,c(rep(0,10)),876851,c(rep(0,10)),430796,c(rep(0,10)),733698,c(rep(0,10)),581636,c(rep(0,10)),232633,c(rep(0,9)),
  
  c(rep(0,2)),1818367,c(rep(0,10)),2496868,c(rep(0,10)),257789,c(rep(0,10)),848793,c(rep(0,10)),358645,c(rep(0,10)),285399,c(rep(0,10)),619993,c(rep(0,10)),
  514479,c(rep(0,10)),376205,c(rep(0,10)),857871,c(rep(0,10)),428549,c(rep(0,10)),619254,c(rep(0,10)),1452384,c(rep(0,10)),1651169,c(rep(0,10)),
  1582272,c(rep(0,10)),802776,c(rep(0,10)),718616,c(rep(0,10)),1186635,c(rep(0,10)),1731557,c(rep(0,10)),1237234,c(rep(0,10)),306852,c(rep(0,10)),
  1038711,c(rep(0,10)),1353168,c(rep(0,10)),691245,c(rep(0,10)),236866,c(rep(0,10)),201868,c(rep(0,10)),926092,c(rep(0,10)),258658,c(rep(0,10)),138186,c(rep(0,10)),
  657088,c(rep(0,10)),218927,c(rep(0,10)),876851,c(rep(0,10)),430796,c(rep(0,10)),733698,c(rep(0,10)),581636,c(rep(0,10)),232633,c(rep(0,8)),
  
  c(rep(0,3)),1818367,c(rep(0,10)),2496868,c(rep(0,10)),257789,c(rep(0,10)),848793,c(rep(0,10)),358645,c(rep(0,10)),285399,c(rep(0,10)),619993,c(rep(0,10)),
  514479,c(rep(0,10)),376205,c(rep(0,10)),857871,c(rep(0,10)),428549,c(rep(0,10)),619254,c(rep(0,10)),1452384,c(rep(0,10)),1651169,c(rep(0,10)),
  1582272,c(rep(0,10)),802776,c(rep(0,10)),718616,c(rep(0,10)),1186635,c(rep(0,10)),1731557,c(rep(0,10)),1237234,c(rep(0,10)),306852,c(rep(0,10)),
  1038711,c(rep(0,10)),1353168,c(rep(0,10)),691245,c(rep(0,10)),236866,c(rep(0,10)),201868,c(rep(0,10)),926092,c(rep(0,10)),258658,c(rep(0,10)),138186,c(rep(0,10)),
  657088,c(rep(0,10)),218927,c(rep(0,10)),876851,c(rep(0,10)),430796,c(rep(0,10)),733698,c(rep(0,10)),581636,c(rep(0,10)),232633,c(rep(0,7)),
  
  c(rep(0,4)),1818367,c(rep(0,10)),2496868,c(rep(0,10)),257789,c(rep(0,10)),848793,c(rep(0,10)),358645,c(rep(0,10)),285399,c(rep(0,10)),619993,c(rep(0,10)),
  514479,c(rep(0,10)),376205,c(rep(0,10)),857871,c(rep(0,10)),428549,c(rep(0,10)),619254,c(rep(0,10)),1452384,c(rep(0,10)),1651169,c(rep(0,10)),
  1582272,c(rep(0,10)),802776,c(rep(0,10)),718616,c(rep(0,10)),1186635,c(rep(0,10)),1731557,c(rep(0,10)),1237234,c(rep(0,10)),306852,c(rep(0,10)),
  1038711,c(rep(0,10)),1353168,c(rep(0,10)),691245,c(rep(0,10)),236866,c(rep(0,10)),201868,c(rep(0,10)),926092,c(rep(0,10)),258658,c(rep(0,10)),138186,c(rep(0,10)),
  657088,c(rep(0,10)),218927,c(rep(0,10)),876851,c(rep(0,10)),430796,c(rep(0,10)),733698,c(rep(0,10)),581636,c(rep(0,10)),232633,c(rep(0,6)),
  
  c(rep(0,5)),1818367,c(rep(0,10)),2496868,c(rep(0,10)),257789,c(rep(0,10)),848793,c(rep(0,10)),358645,c(rep(0,10)),285399,c(rep(0,10)),619993,c(rep(0,10)),
  514479,c(rep(0,10)),376205,c(rep(0,10)),857871,c(rep(0,10)),428549,c(rep(0,10)),619254,c(rep(0,10)),1452384,c(rep(0,10)),1651169,c(rep(0,10)),
  1582272,c(rep(0,10)),802776,c(rep(0,10)),718616,c(rep(0,10)),1186635,c(rep(0,10)),1731557,c(rep(0,10)),1237234,c(rep(0,10)),306852,c(rep(0,10)),
  1038711,c(rep(0,10)),1353168,c(rep(0,10)),691245,c(rep(0,10)),236866,c(rep(0,10)),201868,c(rep(0,10)),926092,c(rep(0,10)),258658,c(rep(0,10)),138186,c(rep(0,10)),
  657088,c(rep(0,10)),218927,c(rep(0,10)),876851,c(rep(0,10)),430796,c(rep(0,10)),733698,c(rep(0,10)),581636,c(rep(0,10)),232633,c(rep(0,5)),
  
  c(rep(0,6)),1818367,c(rep(0,10)),2496868,c(rep(0,10)),257789,c(rep(0,10)),848793,c(rep(0,10)),358645,c(rep(0,10)),285399,c(rep(0,10)),619993,c(rep(0,10)),
  514479,c(rep(0,10)),376205,c(rep(0,10)),857871,c(rep(0,10)),428549,c(rep(0,10)),619254,c(rep(0,10)),1452384,c(rep(0,10)),1651169,c(rep(0,10)),
  1582272,c(rep(0,10)),802776,c(rep(0,10)),718616,c(rep(0,10)),1186635,c(rep(0,10)),1731557,c(rep(0,10)),1237234,c(rep(0,10)),306852,c(rep(0,10)),
  1038711,c(rep(0,10)),1353168,c(rep(0,10)),691245,c(rep(0,10)),236866,c(rep(0,10)),201868,c(rep(0,10)),926092,c(rep(0,10)),258658,c(rep(0,10)),138186,c(rep(0,10)),
  657088,c(rep(0,10)),218927,c(rep(0,10)),876851,c(rep(0,10)),430796,c(rep(0,10)),733698,c(rep(0,10)),581636,c(rep(0,10)),232633,c(rep(0,4)),
  
  c(rep(0,7)),1818367,c(rep(0,10)),2496868,c(rep(0,10)),257789,c(rep(0,10)),848793,c(rep(0,10)),358645,c(rep(0,10)),285399,c(rep(0,10)),619993,c(rep(0,10)),
  514479,c(rep(0,10)),376205,c(rep(0,10)),857871,c(rep(0,10)),428549,c(rep(0,10)),619254,c(rep(0,10)),1452384,c(rep(0,10)),1651169,c(rep(0,10)),
  1582272,c(rep(0,10)),802776,c(rep(0,10)),718616,c(rep(0,10)),1186635,c(rep(0,10)),1731557,c(rep(0,10)),1237234,c(rep(0,10)),306852,c(rep(0,10)),
  1038711,c(rep(0,10)),1353168,c(rep(0,10)),691245,c(rep(0,10)),236866,c(rep(0,10)),201868,c(rep(0,10)),926092,c(rep(0,10)),258658,c(rep(0,10)),138186,c(rep(0,10)),
  657088,c(rep(0,10)),218927,c(rep(0,10)),876851,c(rep(0,10)),430796,c(rep(0,10)),733698,c(rep(0,10)),581636,c(rep(0,10)),232633,c(rep(0,3)),
  
  c(rep(0,8)),1818367,c(rep(0,10)),2496868,c(rep(0,10)),257789,c(rep(0,10)),848793,c(rep(0,10)),358645,c(rep(0,10)),285399,c(rep(0,10)),619993,c(rep(0,10)),
  514479,c(rep(0,10)),376205,c(rep(0,10)),857871,c(rep(0,10)),428549,c(rep(0,10)),619254,c(rep(0,10)),1452384,c(rep(0,10)),1651169,c(rep(0,10)),
  1582272,c(rep(0,10)),802776,c(rep(0,10)),718616,c(rep(0,10)),1186635,c(rep(0,10)),1731557,c(rep(0,10)),1237234,c(rep(0,10)),306852,c(rep(0,10)),
  1038711,c(rep(0,10)),1353168,c(rep(0,10)),691245,c(rep(0,10)),236866,c(rep(0,10)),201868,c(rep(0,10)),926092,c(rep(0,10)),258658,c(rep(0,10)),138186,c(rep(0,10)),
  657088,c(rep(0,10)),218927,c(rep(0,10)),876851,c(rep(0,10)),430796,c(rep(0,10)),733698,c(rep(0,10)),581636,c(rep(0,10)),232633,c(rep(0,2)),
  
  c(rep(0,9)),1818367,c(rep(0,10)),2496868,c(rep(0,10)),257789,c(rep(0,10)),848793,c(rep(0,10)),358645,c(rep(0,10)),285399,c(rep(0,10)),619993,c(rep(0,10)),
  514479,c(rep(0,10)),376205,c(rep(0,10)),857871,c(rep(0,10)),428549,c(rep(0,10)),619254,c(rep(0,10)),1452384,c(rep(0,10)),1651169,c(rep(0,10)),
  1582272,c(rep(0,10)),802776,c(rep(0,10)),718616,c(rep(0,10)),1186635,c(rep(0,10)),1731557,c(rep(0,10)),1237234,c(rep(0,10)),306852,c(rep(0,10)),
  1038711,c(rep(0,10)),1353168,c(rep(0,10)),691245,c(rep(0,10)),236866,c(rep(0,10)),201868,c(rep(0,10)),926092,c(rep(0,10)),258658,c(rep(0,10)),138186,c(rep(0,10)),
  657088,c(rep(0,10)),218927,c(rep(0,10)),876851,c(rep(0,10)),430796,c(rep(0,10)),733698,c(rep(0,10)),581636,c(rep(0,10)),232633,0,
 
   c(rep(0,10)),1818367,c(rep(0,10)),2496868,c(rep(0,10)),257789,c(rep(0,10)),848793,c(rep(0,10)),358645,c(rep(0,10)),285399,c(rep(0,10)),619993,c(rep(0,10)),
  514479,c(rep(0,10)),376205,c(rep(0,10)),857871,c(rep(0,10)),428549,c(rep(0,10)),619254,c(rep(0,10)),1452384,c(rep(0,10)),1651169,c(rep(0,10)),
  1582272,c(rep(0,10)),802776,c(rep(0,10)),718616,c(rep(0,10)),1186635,c(rep(0,10)),1731557,c(rep(0,10)),1237234,c(rep(0,10)),306852,c(rep(0,10)),
  1038711,c(rep(0,10)),1353168,c(rep(0,10)),691245,c(rep(0,10)),236866,c(rep(0,10)),201868,c(rep(0,10)),926092,c(rep(0,10)),258658,c(rep(0,10)),138186,c(rep(0,10)),
  657088,c(rep(0,10)),218927,c(rep(0,10)),876851,c(rep(0,10)),430796,c(rep(0,10)),733698,c(rep(0,10)),581636,c(rep(0,10)),232633),
  
  nrow=47, ncol=396, byrow=T)

model$obj        <- c(
  62395,70460,69632,58059,68738,41732,64916,64892,46368,71407,61452,
  71161,87520,84269,72143,95381,44569,68464,72584,50936,72022,64307,
  13360,15526,15581,13890,12110,14635,13535,14711,14231,16631,15255,
  28280,29542,28454,21497,31246,25742,29922,24316,24891,29398,29324,
  12394,14066,13651,9995,13330,12474,13126,11283,12511,13650,13161,
  8983,9156,8705,6501,9183,8055,9691,7841,8551,9265,9764,
  18164,19366,18908,11848,17111,16526,20061,15622,16600,21522,20652,
  11839,10947,10053,5937,12718,8729,13393,6998,9726,12469,11275,
  7350,7008,6755,2584,7370,5610,8421,4826,6130,8098,7327,
  12026,12504,11909,473,11602,9179,14481,5734,10292,15681,13558,
  9637,6333,5317,7466,10876,6137,10022,5616,7614,7046,8108,
  17501,11540,9990,14160,19211,11794,18079,11802,13927,12678,14485,
  22836,14284,17145,25296,28670,21680,23115,20828,17714,14602,5776,
  27481,11272,15088,25477,34930,17093,27769,19473,18440,13568,5464,
  10296,14846,15402,17968,19657,9870,10258,13832,5264,17868,10772,
  3025,8374,8623,9294,9238,6373,2669,7713,4074,10647,6655,
  18173,8017,8628,16596,20000,13751,18279,13861,14324,7647,10621,
  26699,11920,10376,23231,33337,17182,26486,18481,18921,14141,18691,
  52726,36217,34576,55316,69777,36441,50336,47445,37531,31841,39376,
  48067,38928,36545,50473,59800,34946,44800,44485,29972,33779,34389,
  6944,2466,3617,5579,8756,4535,7004,4366,4787,2848,3434,
  34060,20509,22622,31035,39307,26925,34239,26699,27704,10173,20469,
  33640,13480,14599,30385,38821,24751,33840,25201,25829,13461,17888,
  4263,11693,11903,6435,2672,9781,5110,8519,7950,13147,9762,
  2759,3993,3849,1224,2388,3181,3397,2612,2623,4987,3717,
  2642,4826,4893,3139,900,4337,2901,4244,3765,5187,4294,
  37946,46512,46175,38631,35551,22435,38859,36840,23032,31297,29964,
  8437,9988,9820,7285,8166,7686,9063,8726,6926,9327,9360,
  4332,3114,3590,4136,4893,3418,4358,3559,3529,1148,2350,
  9481,2127,2452,8890,13113,5057,9594,6016,6052,7395,5731,
  8307,9192,9061,7196,7275,8037,8814,8312,7941,9603,9055,
  11009,5324,5715,10224,14485,4759,11181,6933,5741,8941,6365,
  3949,6213,6345,2046,4628,5142,5273,3721,3934,7834,5707,
  15322,8024,5985,12693,18497,9403,15473,9795,11837,10487,11204,
  23808,28485,28151,24433,22413,14090,24106,18470,15573,21436,19508,
  7298,9880,9633,7200,5373,8864,7608,8690,8614,9146,8966
)

# minimiZe total weighted miles
model$modelsense <- "min"
a
# RHS is first Demand constraints then capacity constraints
model$rhs        <- c(
  1818367,2496868,257789,848793,358645,285399,619993,514479,376205,857871,
  428549,619254,1452384,1651169,1582272,802776,718616,1186635,1731557,1237234,
  306852,1038711,1353168,691245,236866,201868,926092,258658,138186,657088,218927,
  876851,430796,733698,581636,232633,
  300000,8000000,1400000,1000000,2200000,6500000,3500000,1600000,1200000,800000,2500000)

# RHS inequality, first 36 '=' demand, next 11 '<=' capacity
model$sense      <- c(c(rep('=',36)),c(rep('<=',11)))
model$vtype      <- 'B'

params <- list(OutputFlag=0)

result <- gurobi(model, params)

print('Solution:')
print(result$status)
print(result$runtime)
print(result$objval)
print(result$x)

DecisionRevCost719 <- as.data.frame(matrix(result$x, ncol=11, byrow=TRUE),row.names = c(
  "Northern California","Southern California","Alaska & Hawaii",
"Arizona","Nevada","New Mexico","Colorado","Oklahoma","Kansas","Missouri","Mississippi","Louisiana","Michigan",
"Ohio","Illinois","Wisconsin","South Carolina","Georgia","Northern Florida","Southern Florida","West Viginia",
"Virginia","North Carolina","Minnesota","Nebraska","North Dakota and South Dakota","Washington","Utah","Delaware",
"Kentucky","Idaho","Indiana","Iowa","Alabama","Oregon","Montana and Wyoming"))

colnames(DecisionRevCost719) <- (c("Baraboo WI","Danville KY","Glasgow KY","Liberty MO","Long Prairie MN",
               "Mattoon IL","Menasha WI","Owensville MO","Pontiac IL","Strasburg VA","Willard OH"))
             
write.csv(DecisionRevCost719,file ="DecisionRevCost719.csv")

View(DecisionRevCost719)

###





